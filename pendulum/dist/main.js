(()=>{"use strict";const n=()=>new Path2D,t=n=>t=>()=>(t.stroke(n),null),r=n=>t=>()=>(t.strokeStyle=n,null),u=n=>t=>r=>u=>e=>i=>()=>(i.arc(n,t,r,u,e),null);var e={show:function(n){var t=n.toString();return isNaN(t+".0")?t:t+".0"}},i={show:function(n){return n.toString()}},o=function(n){return n.show},c=function(){function n(n,t,r,u){this.value0=n,this.value1=t,this.value2=r,this.value3=u}return n.create=function(t){return function(r){return function(u){return function(e){return new n(t,r,u,e)}}}},n}(),a=function(){return c.create}(),f=function(n){return function(t){return function(r){return new c(n,t,r,1)}}},s=f(0)(255)(0),l=f(0)(0)(0),v={x:0,y:0},m={compose:function(n){return function(t){return function(r){return n(t(r))}}}},d=function(n){return n.identity},h={identity:function(n){return n},Semigroupoid0:function(){return m}};var p={append:function(n){return function(t){return 0===n.length?t:0===t.length?n:n.concat(t)}}},R=function(n){return n.append},S=d(h),w=function(n){return n.apply},y=function(n){return n.pure};String.fromCharCode(65535),String.fromCharCode(0),Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY;const g=function(n){return function(t){return function(r){return function(u){return function(e){return u<e?n:u===e?t:r}}}}};var M={eq:function(n){return function(t){return n===t}}},b=function(){function n(){}return n.value=new n,n}(),A=function(){function n(){}return n.value=new n,n}(),F=function(){function n(){}return n.value=new n,n}(),E=function(){return{compare:g(b.value)(F.value)(A.value),Eq0:function(){return M}}}(),q=function(n){return n.top},N={top:2147483647,bottom:-2147483648,Ord0:function(){return E}},P=function(n){return n.bottom},C=d(h),I=function(){function n(){}return n.value=new n,n}(),x=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),T=function(n){return n.foldr},Y=function(n){var t,r,u,e=(t=n.Apply0(),r=w(t),u=t.Functor0().map,function(n){return function(t){return r(u(function(n){return function(t){return n}}(S))(n))(t)}}),i=y(n);return function(n){var t=T(n);return function(n){return t((function(t){return e(n(t))}))(i(undefined))}}},D={foldr:function(n){return function(t){return function(r){for(var u=t,e=r.length-1;e>=0;e--)u=n(r[e])(u);return u}}},foldl:function(n){return function(t){return function(r){for(var u=t,e=r.length,i=0;i<e;i++)u=n(u)(r[i]);return u}}},foldMap:function(n){return(t=T(D),function(n){var r=R(n.Semigroup0()),u=n.mempty;return function(n){return t((function(t){return function(u){return r(n(t))(u)}}))(u)}})(n);var t}};isNaN;const O=isFinite;Math.abs,Math.acos,Math.asin,Math.atan,Math.ceil;const X=Math.cos,k=(Math.exp,Math.floor,Math.log,Math.round),B=(Math.sign&&Math.sign,Math.sin);Math.sqrt,Math.tan,Math.trunc&&Math.trunc;var G=3.141592653589793,V=function(n){var t=n.Bind1().bind,r=y(n.Applicative0());return function(n){return function(u){return t(n)((function(n){return t(u)((function(t){return r(n(t))}))}))}}},_=function(n,t,r){var u,e=0;return function(i){if(2===e)return u;if(1===e)throw new ReferenceError(n+" was needed before it finished initializing (module "+t+", line "+i+")",t,i);return e=1,u=r(),e=2,u}},z={Applicative0:function(){return j},Bind1:function(){return L}},L={bind:function(n){return function(t){return function(){return t(n())()}}},Apply0:function(){return J(0)}},j={pure:function(n){return function(){return n}},Apply0:function(){return J(0)}},H=_("functorEffect","Effect",(function(){return{map:(n=j,t=w(n.Apply0()),r=y(n),function(n){return function(u){return t(r(n))(u)}})};var n,t,r})),J=_("applyEffect","Effect",(function(){return{apply:V(z),Functor0:function(){return H(0)}}})),K=o(e),Q=o(i),U=Y(j)(D),W=function(){function n(n,t,r){this.value0=n,this.value1=t,this.value2=r}return n.create=function(t){return function(r){return function(u){return new n(t,r,u)}}},n}(),Z=function(){function n(n,t,r){this.value0=n,this.value1=t,this.value2=r}return n.create=function(t){return function(r){return function(u){return new n(t,r,u)}}},n}(),$=function(){function n(n,t,r){this.value0=n,this.value1=t,this.value2=r}return n.create=function(t){return function(r){return function(u){return new n(t,r,u)}}},n}(),nn=function(n){return function(t){return function(r){return[new $(n,t,r)]}}},tn=function(n){return"rgba("+Q(n.value0)+","+Q(n.value1)+","+Q(n.value2)+","+K(n.value3)+")"},rn=function(n){return function(t){return function(r){return[new W(n,t,r)]}}},un=function(n){return function(t){return{canvasX:n.width/2+10*t.x,canvasY:n.height/2-10*t.y}}};const en=n=>t=>t%n;var on=q(N),cn=P(N),an=function(){return(n=x.create,function(t){return function(r){return(0|r)===r?n(r):t}})(I.value);var n}(),fn=function(n){return O(n)?n>=on?on:n<=cn?cn:(t=0,function(n){return function(r){if(r instanceof I)return t;if(r instanceof x)return n(r.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,n.constructor.name,r.constructor.name])}})(C)(an(n)):0;var t},sn=R(p),ln=y(j),vn=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),mn=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),dn=function(n){return function(t){return function(r){if(t instanceof vn)return ln((e=n,u=function(n){return function(t){var r=B(n.positionR-n.positionS),u=X(n.positionR-n.positionS),i=e.radiusR*e.radiusS,o=e.radiusS*e.radiusS,c=X(n.positionS),a=n.velocityR*n.velocityR*i*r-e.gravity*e.radiusS*c,f=X(n.positionR),s=-n.velocityS*n.velocityS*i*r-e.gravity*e.massR*e.radiusR*f,l=i*u,v=e.massR*e.radiusR*e.radiusR,m=1/(v*o-l*l),d=m*o*s+-m*l*a,h=-m*l*s+m*v*a;return{time:n.time+t,positionR:en(2*G)(n.positionR+t*n.velocityR),positionS:en(2*G)(n.positionS+t*n.velocityS),velocityR:n.velocityR+t*d,velocityS:n.velocityS+t*h}}},function(n){return function(t){return function(r){var e,i=fn(k(n/r));return(e=u,function(n){return function(t){return function(r){var u,i=e,o=n,c=t,a=!1;function f(n,t,u,e){if(0===t)return a=!0,u;i=n,o=t-1|0,c=n(u)(e),r=e}for(;!a;)u=f(i,o,c,r);return u}}})(i)(t)(r)}}})(t.value0/1e3)(r)(.001));var u,e;if(t instanceof mn)return ln(t.value0);throw new Error("Failed pattern match at ClassicalMechanics.DoublePendulum (line 108, column 3 - line 114, column 20): "+[t.constructor.name])}}};function hn(n){return()=>document.createElement(n)}const pn=n=>t=>()=>(n.appendChild(t),null),Rn=n=>t=>r=>()=>(n.setAttribute(t,r),null);var Sn=o(e);const wn=n=>t=>()=>{let r=t;return{getModel:()=>r,send(t){setTimeout((()=>{r=n(this)(t)(r)()}),0)}}},yn=n=>t=>()=>(t.send(n),null),gn=n=>()=>n.getModel();var Mn={width:1e3,height:900};!function(){var e=document.body,i=function(n){return function(){var t=hn("canvas")();Rn(t)("width")(Sn(n.width))(),Rn(t)("height")(Sn(n.height))();var r=(n=>()=>n.getContext("2d"))(t)();return{canvasRef:r,canvasDOM:t}}}(Mn)();pn(e)(i.canvasDOM)(),Rn(i.canvasDOM)("style")("border: 1px solid black")();var o={time:0,positionR:-.3*G,positionS:0,velocityR:-2,velocityS:3.5},c={gravity:9.8,radiusR:25,radiusS:10,massR:2,massS:50},f={shouldRequestAnimationFrame:!0,timestamp:0,pendulumState:o},m=function(n){return t=function(t){return function(){var r=gn(n)();return yn({shouldRequestAnimationFrame:r.shouldRequestAnimationFrame,timestamp:t,pendulumMsg:new vn(t-r.timestamp)})(n)()}},()=>{window.requestAnimationFrame((n=>t(n)()))};var t},d=wn((function(e){return function(o){return function(f){return function(){var d,h,p,R=dn(c)(o.pendulumMsg)(f.pendulumState)();return(h=(d=Mn).width,n=>t=>()=>(t.clearRect(0,0,h,n),null))(d.height)(i.canvasRef)(),(p=Mn,function(e){return function(i){return U(function(e){return function(i){return function(o){if(o instanceof W){var c=un(e)(o.value1);return function(){var e=n();return u(c.canvasX)(c.canvasY)(o.value2)(0)(2*G)(e)(),r(tn(o.value0))(i)(),t(e)(i)()}}if(o instanceof Z)return c=un(e)(o.value1),function(){var t,r,e=n();return u(c.canvasX)(c.canvasY)(o.value2)(0)(2*G)(e)(),(t=tn(o.value0),n=>()=>(n.fillStyle=t,null))(i)(),(r=e,n=>()=>(n.fill(r),null))(i)()};if(o instanceof $){var a=un(e)(o.value1),f=un(e)(o.value2);return function(){var u,e=n();return(u=a.canvasX,n=>t=>()=>(t.moveTo(u,n),null))(a.canvasY)(e)(),(n=>t=>r=>()=>(r.lineTo(n,t),null))(f.canvasX)(f.canvasY)(e)(),r(tn(o.value0))(i)(),t(e)(i)()}}throw new Error("Failed pattern match at CanvasGeometry.Element (line 64, column 3 - line 88, column 43): "+[o.constructor.name])}}}(p)(e))(i)}})(i.canvasRef)(function(n){return function(t){var r=function(n){return function(t){var r=n.radiusR*B(t.positionR),u=n.radiusR*X(t.positionR);return{cartesianPositionR:{x:u,y:r},cartesianPositionS:{x:u+n.radiusS*X(t.positionS),y:r+n.radiusS*B(t.positionS)}}}}(n)(t);return sn(rn(l)(r.cartesianPositionR)(20))(sn(rn(a(0)(0)(0)(.1))(v)(10*n.radiusR))(sn(nn(l)(v)(r.cartesianPositionR))(sn(rn(s)(r.cartesianPositionS)(20))(sn(rn(a(1)(0)(0)(.1))(r.cartesianPositionR)(10*n.radiusS))(nn(s)(r.cartesianPositionR)(r.cartesianPositionS))))))}}(c)(R))(),o.shouldRequestAnimationFrame&&m(e)(),{timestamp:o.timestamp,pendulumState:R,shouldRequestAnimationFrame:f.shouldRequestAnimationFrame}}}}}))(f)();m(d)();var h,p,R=hn("button")();pn(e)(R)(),(h=R,n=>()=>(h.textContent=n,null))("State 0")(),(p=R,function(n){return(n=>t=>()=>(n.addEventListener("click",t),null))(p)((function(){var t=gn(d)();return yn({shouldRequestAnimationFrame:!1,timestamp:t.timestamp,pendulumMsg:new mn(n)})(d)()}))})(o)()}()})();