(()=>{"use strict";const n=()=>new Path2D,t=n=>t=>()=>(t.stroke(n),null);var r={compose:function(n){return function(t){return function(r){return n(t(r))}}}},e=function(n){return n.identity},u={identity:function(n){return n},Semigroupoid0:function(){return r}};String.fromCharCode(65535),String.fromCharCode(0),Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY;const i=function(n){return function(t){return function(r){return function(e){return function(u){return e<u?n:e===u?t:r}}}}};var o={eq:function(n){return function(t){return n===t}}},a=function(){function n(){}return n.value=new n,n}(),c=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}();var s=function(){return{compare:i(a.value)(f.value)(c.value),Eq0:function(){return o}}}(),l=function(n){return n.top},v={top:2147483647,bottom:-2147483648,Ord0:function(){return s}},m=function(n){return n.bottom},h=function(n){return n.pure},d={show:function(n){var t=n.toString();return isNaN(t+".0")?t:t+".0"}},p={show:function(n){if(n)return"true";if(!n)return"false";throw new Error("Failed pattern match at Data.Show (line 29, column 1 - line 31, column 23): "+[n.constructor.name])}},w=function(n){return n.show},M=e(u),y=function(){function n(){}return n.value=new n,n}(),g=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}();isNaN;const b=isFinite;Math.abs,Math.acos,Math.asin,Math.atan,Math.ceil;const A=Math.cos,F=(Math.exp,Math.floor,Math.log,Math.round),S=(Math.sign&&Math.sign,Math.sin);Math.sqrt,Math.tan,Math.trunc&&Math.trunc;var E=3.141592653589793,q=l(v),R=m(v),N=function(){return(n=g.create,function(t){return function(r){return(0|r)===r?n(r):t}})(y.value);var n}(),I=function(n){return b(n)?n>=q?q:n<=R?R:(t=0,function(n){return function(r){if(r instanceof y)return t;if(r instanceof g)return n(r.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,n.constructor.name,r.constructor.name])}})(M)(N(n)):0;var t},C=function(n){var t=n.Bind1().bind,r=h(n.Applicative0());return function(n){return function(e){return t(n)((function(n){return t(e)((function(t){return r(n(t))}))}))}}},x=function(n,t,r){var e,u=0;return function(i){if(2===u)return e;if(1===u)throw new ReferenceError(n+" was needed before it finished initializing (module "+t+", line "+i+")",t,i);return u=1,e=r(),u=2,e}},T={Applicative0:function(){return Y},Bind1:function(){return D}},D={bind:function(n){return function(t){return function(){return t(n())()}}},Apply0:function(){return X(0)}},Y={pure:function(n){return function(){return n}},Apply0:function(){return X(0)}},O=x("functorEffect","Effect",(function(){return{map:(n=Y,t=n.Apply0().apply,r=h(n),function(n){return function(e){return t(r(n))(e)}})};var n,t,r})),X=x("applyEffect","Effect",(function(){return{apply:C(T),Functor0:function(){return O(0)}}})),k=h(Y),P=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),B=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),V=function(n){return function(t){return function(r){if(t instanceof P)return k((e=function(n){return function(t){return function(r){return{time:t.time+r,position:t.position+r*t.velocity,velocity:t.velocity+r*(-n.gravity/n.radius)*A(t.position)}}}}(n),function(n){return function(t){return function(r){var u,i=I(F(n/r));return(u=e,function(n){return function(t){return function(r){var e,i=u,o=n,a=t,c=!1;function f(n,t,e,u){if(0===t)return c=!0,e;i=n,o=t-1|0,a=n(e)(u),r=u}for(;!c;)e=f(i,o,a,r);return e}}})(i)(t)(r)}}})(t.value0/1e3)(r)(.001));var e;if(t instanceof B)return k(t.value0);throw new Error("Failed pattern match at ClassicalMechanics.Pendulum (line 56, column 3 - line 64, column 20): "+[t.constructor.name])}}};function _(n){return()=>document.createElement(n)}const z=n=>t=>()=>(n.appendChild(t),null),G=n=>t=>r=>()=>(n.setAttribute(t,r),null),L=n=>t=>()=>(n.textContent=t,null);var j=w(d);const H=n=>t=>()=>{let r=t;return{getModel:()=>r,send(t){setTimeout((()=>{r=n(this)(t)(r)()}),0)}}},J=n=>t=>()=>(t.send(n),null),K=n=>()=>n.getModel();var Q=w(p),U={width:1e3,height:900};!function(){var r=document.body,e=function(n){return function(){var t=_("canvas")();G(t)("width")(j(n.width))(),G(t)("height")(j(n.height))();var r=(n=>()=>n.getContext("2d"))(t)();return{canvasRef:r,canvasDOM:t}}}(U)();z(r)(e.canvasDOM)(),G(e.canvasDOM)("style")("border: 1px solid black")();var u={time:0,position:0,velocity:0},i={time:0,position:.3*E,velocity:0},o={time:0,position:.3*E,velocity:-2},a={time:0,position:.3*E,velocity:6},c={time:0,position:-.5*E,velocity:0},f={time:0,position:-.52*E,velocity:0},s={time:0,position:-.5*E,velocity:20},l={gravity:9.8,radius:25},v={shouldRequestAnimationFrame:!0,timestamp:0,pendulumState:u},m=function(n){return t=function(t){return function(){var r=K(n)();return J({shouldRequestAnimationFrame:r.shouldRequestAnimationFrame,timestamp:t,pendulumMsg:new P(t-r.timestamp)})(n)()}},()=>{window.requestAnimationFrame((n=>t(n)()))};var t},h=H((function(r){return function(u){return function(i){return function(){var o,a,c,f,s=V(l)(u.pendulumMsg)(i.pendulumState)();return(f=(a=(o=U).width,n=>t=>()=>(t.clearRect(0,0,a,n),null))(o.height),function(r){return function(e){return function(u){return function(i){return function(){f(i)();var o,a,c=r((o=e,function(n){return{x:o.radius*A(n.position),y:o.radius*S(n.position)}})(u)),s=r({x:0,y:0}),l=n();(a=s.canvasX,n=>t=>()=>(t.moveTo(a,n),null))(s.canvasY)(l)(),(n=>t=>r=>()=>(r.lineTo(n,t),null))(c.canvasX)(c.canvasY)(l)(),t(l)(i)();var v=n();return(n=>t=>r=>e=>u=>i=>()=>(i.arc(n,t,r,e,u),null))(c.canvasX)(c.canvasY)(20)(0)(2*E)(v)(),void t(v)(i)()}}}}})(function(n){return function(t){return{canvasX:n.width/2+10*t.x,canvasY:n.height/2-10*t.y}}}(U))(l)(s)(e.canvasRef)(),(c=Q(i.shouldRequestAnimationFrame),function(){console.log(c)})(),u.shouldRequestAnimationFrame&&m(r)(),{timestamp:u.timestamp,pendulumState:s,shouldRequestAnimationFrame:i.shouldRequestAnimationFrame}}}}}))(v)();m(h)();var d=_("button")();z(r)(d)(),L(d)("State 0")();var p=_("button")();z(r)(p)(),L(p)("State 1")();var w=_("button")();z(r)(w)(),L(w)("State 2")();var M=_("button")();z(r)(M)(),L(M)("State 3")();var y=_("button")();z(r)(y)(),L(y)("State 4")();var g=_("button")();z(r)(g)(),L(g)("State 5")();var b=_("button")();z(r)(b)(),L(b)("State 6")();var F=function(n){return function(t){return(r=n,n=>()=>(r.addEventListener("click",n),null))((function(){var n=K(h)();return J({shouldRequestAnimationFrame:!1,timestamp:n.timestamp,pendulumMsg:new B(t)})(h)()}));var r}};F(d)(u)(),F(p)(i)(),F(w)(o)(),F(M)(a)(),F(y)(c)(),F(g)(f)(),F(b)(s)()}()})();